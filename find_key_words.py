# installing packages on cl: 
# pip3 install sklearn
# pip3 install spacy
# python -m spacy download en_core_web_sm


from sklearn.feature_extraction.text import CountVectorizer
import spacy
from transformers import AutoModel, AutoTokenizer
from sklearn.metrics.pairwise import cosine_similarity

def nlp(text:str):
    """
    Takes in a transcript as str
    Returns 50 length array of most common keywords
    """
    n_gram_range = (1,2)
    stop_words = "english"
    count = CountVectorizer(ngram_range=n_gram_range, stop_words=stop_words).fit([text])
    all_candidates = count.get_feature_names_out()
    # print(all_candidates[:10])

    nlp = spacy.load('en_core_web_sm')
    doc = nlp(text)
    noun_phrases = set(chunk.text.strip().lower() for chunk in doc.noun_chunks)

    nouns = set() # focus on nouns
    for token in doc:
        if token.pos_ == "NOUN":
            nouns.add(token.text)
    all_nouns = nouns.union(noun_phrases)
    candidates = list(filter(lambda candidate: candidate in all_nouns, all_candidates))
    # print(candidates[:10])

    model_name = "distilroberta-base" # transformer encoder
    model = AutoModel.from_pretrained(model_name)
    tokenizer = AutoTokenizer.from_pretrained(model_name)
    candidate_tokens = tokenizer(candidates, padding=True, return_tensors="pt")
    candidate_embeddings = model(**candidate_tokens)["pooler_output"]
    # print(candidate_embeddings.shape)

    text_tokens = tokenizer([text], return_tensors="pt", max_length=512, truncation=True, padding="max_length")
    text_embedding = model(**text_tokens)["pooler_output"]
    # print(text_embedding.shape)

    candidate_embeddings = candidate_embeddings.detach().numpy()
    text_embedding = text_embedding.detach().numpy()
    top_k = 50
    distances = cosine_similarity(text_embedding, candidate_embeddings)
    keywords = [candidates[index] for index in distances.argsort()[0][-top_k:]]
    return keywords

# can get transcripts easily using Whisper, just doing it manually for now

# test_url_1: https://www.youtube.com/watch?v=jANZxzetPaQ
text1 = "Very good. So it's time to start. So today, I want to talk about general features of quantum mechanics. Quantum mechanics is something that takes some time to learn, and we're going to be doing some of that learning this semester. But I want to give you a perspective of where we're going, what are the basic features, how quantum mechanics looks, what's surprising about it, and introduce some ideas that will be relevant throughout this semester and some that will be relevant for later courses as well. So it's an overview of quantum mechanics. So quantum mechanics, at this moment, is almost 100 years old. Officially-- and we will hear-- this year, in 2016, we're celebrating the centenary of general relativity. And when will the centenary of quantum mechanics be? I'm pretty sure it will be in 2025. Because in 1925, Schrodinger and Heisenberg pretty much wrote down the equations of quantum mechanics. But quantum mechanics really begins earlier. The routes that led to quantum mechanics began in the late years of the 19th century with work of Planck, and then at the beginning of the century, with work of Einstein and others,m as we will see today and in the next few lectures. So the thoughts, the puzzles, the ideas that led to quantum mechanics begin before 1925, and in 1925, it suddenly happened. So what is quantum mechanics? Quantum mechanics is really a framework to do physics, as we will understand. So quantum physics has replaced classical physics as the correct description of fundamental theory. So classical physics may be a good approximation, but we know that at some point, it's not quite right. It's not only not perfectly accurate. It's conceptually very different from the way things really work. So quantum physics has replaced classical physics. And quantum physics is the principles of quantum mechanics applied to different physical phenomena. So you have, for example, quantum electrodynamics, which is quantum mechanics applied to electromagnetism. You have quantum chromodynamics, which is quantum mechanics applied to the strong interaction. You have quantum optics when you apply quantum mechanics to photons. You have quantum gravity when you try to apply quantum mechanics to gravitation. Why the laughs? And that's what gives rise to string theory, which is presumably a quantum theory of gravity, and in fact, the quantum theory of all interactions if it is correct. Because it not only describes gravity, but it describes all other forces. So quantum mechanics is the framework, and we apply it to many things. So what are we going to cover today? What are we going to review? Essentially five topics-- one, the linearity of quantum mechanics, two, the necessity of complex numbers, three, the laws of determinism, four, the unusual features of superposition, and finally, what is entanglement. So that's what we aim to discuss today. So we'll begin with number one, linearity. And that's a very fundamental aspect of quantum mechanics, something that we have to pay a lot of attention to. So whenever you have a theory, you have some dynamical variables. These are the variables you want to find their values because they are connected with observation. If you have dynamical variables, you can compare the values of those variables, or some values deduced from those variables, to the results of an experiment. So you have the equations of motion, so linearity. We're talking linearity. You have some equations of motion, EOM. And you have dynamical variables. If you have a theory, you have some equations, and you have to solve for those dynamical variables. And the most famous example of a theory that is linear is Maxwell's theory of electromagnetism. Maxwell's theory of electromagnetism is a linear theory. What does that mean? Well, first, practically, what it means is that if you have a solution-- for example, a plane wave propagating in this direction-- and you have another solution-- a plane wave propagating towards you-- then you can form a third solution, which is two plane waves propagating simultaneously. And you don't have to change anything. You can just put them together, and you get a new solution. The two waves propagate without touching each other, without affecting each other. And together, they form a new solution. This is extraordinarily useful in practice because the air around us is filled with electromagnetic waves. All your cell phones send electromagnetic waves up the sky to satellites and radio stations and transmitting stations, and the millions of phone calls go simultaneously without affecting each other. A transatlantic cable can conduct millions of phone calls at the same time, and as much data and video and internet. It's all superposition. All these millions of conversations go simultaneously through the cable without interfering with each other. Mathematically, we have the following situation. In Maxwell's theory, you have an electric field, a magnetic field, a charge density, and a current density. That's charge per unit area per unit of time. That's the current density. And this set of data correspond to a solution if they satisfy Maxwell's equations, which is a set of equations for the electromagnetic field, charged densities, and current density. So suppose this is a solution, that you verify that it solves Maxwell's equation. Then linearity implies the following. You multiply this by alpha, alpha e, alpha b, alpha rho, and alpha j. And think of this as the new electric field, the new magnetic field, the new charged density, and the new current is also a solution. If this is a solution, linearity implies that you can multiply those values by a number, a constant number, a alpha being a real number. And this is still a solution. It also implies more. Linearity means another thing as well. It means that if you have two solutions, e1, b1, rho 1, j1, and e2, b2, rho 2, j2-- if these are two solutions, then linearity implies that the sum e1 plus e2, b1 plus b2, rho 1 plus rho 2, and j1 plus j2 is also a solution. So that's the meaning, the technical meaning of linearity. We have two solutions. We can add them. We have a single solution. You can scale it by a number. Now, I have not shown you the equations and what makes them linear. But I can explain this a little more as to what does it mean to have a linear equation. Precisely what do we mean by a linear equation? So a linear equation. And we write it schematically. We try to avoid details. We try to get across the concept. A linear equation, we write this l u equal 0 where u is your unknown and l is what is called the linear operator, something that acts on u. And that thing, the equation, is of the form l and u equal 0. Now, you might say, OK, that already looks to me a little strange, because you have just one unknown, and here we have several unknowns. So this is not very general. And you could have several equations. Well, that won't change much. We can have several linear operators if you have several equations, like l1 or something, l2 on something, all these ones equal to 0 as you have several equations. So you can have several u's or several unknowns, and you could say something like you have l on u, v, w equals 0 where you have several unknowns. But it's easier to just think of this first. And once you understand this, you can think about the case where you have many equations. So what is a linear equation? It's something in which this l-- the unknown can be anything, but l must have important properties, as being a linear operator will mean that l on a times u, where a is a number, should be equal to alu and l on u1 plus u2 on two unknowns is equal to lu 1 lu 2. This is what we mean by the operator being linear. So if an operator is linear, you also have l on alpha u1 plus beta u2. You apply first the second property, l on the first plus l on the second. So this is l of alpha u1 plus l of beta u2. And then using the first property, this is alpha l of u1 plus beta l of u2. And then you realize that if u1 and u2 are solutions-- which means lu 1 equal lu 2 equals 0 if they solve the equation-- then alpha u1 plus beta u2 is a solution. Because if lu1 is 0 and lu2 is 0, l of alpha u1 plus beta u2 is 0, and it is a solution. So this is how we write a linear equation. Now, an example probably would help. If I have the differential equation du dt plus 1 over tau u equals 0, I can write it as an equation of the form lu equals 0 by taking l on u to be defined to be vu vt plus 1 over tau u. Now, it's pretty much-- I haven't done much here. I've just said, look, let's define l [? active ?] [? on ?] u to be this. And then certainly, this equation is just lu equals 0. The question would be maybe if somebody would tell you how do you write l alone-- well, l alone, probably we should write it as d dt without anything here plus 1 over tau. Now, that's a way you would write it to try to understand yourself what's going on. And you say, well, then when l acts as the variable u, the first term takes the derivative, and the second term, which is a number, just multiplies it. So you could write l as this thing. And now it is straightforward to check that this is a linear operator. l is linear. And for that, you have to check the two properties there. So for example, l on au would be ddt of au plus 1 over tau au, which is a times du d tau plus 1 over tau u, which is alu. And you can check. I asked you to check the other property l on u1 plus u2 is equal to lu 1 plus lu 2. Please do it."
t1 = nlp(text1)
# print(t1)

# test_url_2: https://www.youtube.com/watch?v=kiuwtaprFjk
text2 = "So here is of something funny. You might say, OK, what is simpler? A theory that is linear or a theory that is not linear? And the answer, of course, a linear theory is much simpler. General-- Maxwell's equations are linear. Einstein's theory of relativity is very nonlinear, very complicated. How about classical mechanics? Is classical mechanics linear or nonlinear? What do we think? Can't hear anyone. Linear, OK. You may think it's linear because it's supposed to be simple, but it's not. It's actually is very nonlinear. Newton could solve the two body problem but he couldn't solve the three body problem. Already with three bodies, you cannot superpose solutions that you get with two bodies. It's extraordinarily complicated, classical mechanics. Let me show you. If you have motion in one dimension, in 1D, you have the equation of motion, motion in one dimension, and there are potential V of x, that this time independent-- a particle moving in one dimension x with under the influence of a potential, V of x. The second-- the dynamical variable is x of t. The dynamical variable. And the equation of motion is-- so let me explain this. This is force equal mass times acceleration. This is mass, this is acceleration, the second derivative of the position, and V force is minus the derivative of the potential evaluated at the position. You know, derivatives of potentials-- if you think of a potential, the derivative of the potential is here positive, and you know if you have a mass here, it tends to go to the left, so the force is on the left, so it's minus. So V prime is the derivative of V with respect to its argument. And the problem is that while this, taking derivatives, is a linear operation. If you take two derivatives of a sum of things, you take two derivatives of the first plus two derivatives of the second. But yes, its-- this side is linear, but this side may not be linear. Because a potential can be arbitrary. And that the reverse-- so suppose the potential is cubic in x. V of x goes like x cubed. Then the derivative of V goes like x squared, and x squared is not a linear function. So this, Newton's equation, is not a linear equation. And therefore, it's complicated to solve. Very complicated to solve. So finally, we can get to our case, quantum mechanics. So in quantum mechanics, what do we have? Quantum mechanics is linear. First, you need an equation, and whose equation is it? Schrodinger's equation, 1925. He writes an equation for the dynamical variable, and the dynamical variable is something called the wave function. This wave function can depend on t-- depends on time-- and it may depend on other things as well. And he describes the dynamics of the quantum system as it evolved in time. There is the wave function, and you have an equation for this wave function. And what is the equation for this wave function? It's a universal equation-- i hbar partial derivative with respect to time of psi is equal to H hat of psi, where H hat is called the Hamiltonian and it's a linear operator. That's why I had to explain a little bit what the linear operator is. This is the general structure of the Schrodinger equation-- time derivative and the linear operator. So if you wish to write the Schrodinger equation as an L psi equals 0, then L psi would be defined i hbar del/del t of psi minus H hat psi. Then this is the Schrodinger equation. This equation here is Schrodinger's equation. And as you can see, it's a linear equation. You can check it, check that L is a linear operator. Therefore, it is naturally linear, you can see, because you do it differently, because the derivative with respect to time is a linear operation. If you have the ddt of a number of times a function, the number goes out, you differentiate the function. ddt of the sum of two functions, you differentiate the first, you differentiate. So this is linear and H we said is linear, so L is going to be linear and the Schrodinger equation is going to be a linear equation, and therefore, you're going to have the great advantage that any time you find solutions, you can scale them, you can add them, you can put them together, combine them in superpositions, and find new solutions. So in that sense, it's remarkable that quantum mechanics is simpler than classical mechanics. And in fact, you will see throughout this semester how the mathematics and the things that we do are simpler in quantum mechanics, or more elegant, more beautiful, more coherent, it's simpler and very nice. OK, i is the square root of minus 1, is the imaginary unit, and that's what we're going to talk next on the necessity of complex numbers. hbar, yes, it's a number. It shows up in quantum mechanics early on. It it's called Planck's constant and it began when Planck tried to fit the black value spectrum and he found the need to put a constant in there, and then later, Einstein figured out that it was very relevant, so yes, it's a number. For any physical system that you have, you will have a wave function and you will have a Hamiltonian, and the Hamiltonian is for you to invent or for you to discover. So if you have a particle moving on a line, the wave function will depend on time and on x. If you have a particle moving in three dimensions, it will depend on x vector. It may depend on other things as well or it maybe, like, one particle has several wave functions and that happens when you have a particle with spin. So in general, always time, sometimes position, there may be cases where it doesn't depend on position. You think of an electron at some point in space and it's fixed-- you lock it there and you want understand the physics of that electron locked into place, and then position is not relevant. So what it does with its spin is relevant and then you may need more than one wave function-- what is one describing the spin up and one describing the spin down? So it was funny that Schrodinger wrote this equation and when asked, so what is the wave function? He said, I don't know. No physical interpretation for the wave function was obvious for the people that invented quantum mechanics. It took a few months until Max Born said it has to do with probabilities, and that's what we're going to get next. So our next point is the necessity of complex numbers in quantum mechanics."
t2 = nlp(text2)
# print(t2)

# test_url_3: https://www.youtube.com/watch?v=f079K1f2WQk
text3 = "So in quantum mechanics,  you see this i appearing here, and it's a complex number--  the square root of minus 1.  And that shows that somehow complex numbers  are very important.  Well it's difficult to overemphasize  the importance of i--  is the square root of minus 1 was invented by people in order  to solve equations.  Equations like x squared equals minus 1.  And it so happens that once you invent i  you need to invent more numbers, and you  can solve every polynomial equation with just i.  And square root of i-- well square root of i  can be written in terms of i and other numbers.  So if you have a complex number z--  we sometimes write it this way, and we  say it belongs to the complex numbers,  and with a and b belonging to the real numbers.  And we say that the real part of z  is a, the imaginary part of z is b.  We also define the complex conjugate of z,  which is a minus i b and we picture the complex number z  by putting a on the x-axis b on the y-axis,  and we think of the complex number z here--  kind of like putting the real numbers here  and the imaginary parts here.  So you can think of this as ib or b,  but this is the complex number-- maybe ib would be a better way  to write it here.  So with complex numbers, there is one more useful identity.  You define the norm of the complex number  to be square root of a squared plus b squared  and then this results in the norm  squared being a squared plus b squared.  And it's actually equal to z times z star.  A very fundamental equation--  z times z star--  if you multiply z times z star, you  get a squared plus b squared.  So the norm squared--  the norm of this thing is a real number.  And that's pretty important.  So there is one other identity that is very useful  and I might well mention it here as we're  going to be working with complex numbers.  And for more practice on complex numbers,  you'll see the homework.  So suppose I have in the complex plane an angle theta,  and I want to figure out what is this complex number z here  at unit radius.  So I would know that it's real part would be cosine theta.  And its imaginary part would be sine theta.  It's a circle of radius 1.  So that must be the complex number.  z must be equal to cosine theta plus i sine theta.  Because the real part of it is cosine theta.  It's in that horizontal part's projection.  And the imaginary part is the vertical projection.  Well the thing that is very amazing  is that this is equal to e to the i theta.  And that is very non-trivial.  To prove it, you have to work a bit,  but it's a very famous result and we'll use it.  So that is complex numbers.  So complex numbers you use them in electromagnetism.  You sometimes use them in classical mechanics,  but you always use it in an auxiliary way.  It was not directly relevant because the electric field  is real, the position is, real the velocity is real--  everything is real and the equations are real.  On the other hand, in quantum mechanics,  the equation already has an i.  So in quantum mechanics, psi is a complex number necessarily.  It has to be.  In fact, if it would be real, you would have a contradiction  because if psi is real, turns out  for all physical systems we're interested in, H on psi real  gives you a real thing.  And here, if psi is real then the relative is real,  and this is imaginary and you have a contradiction.  So there are no solutions that are real.  So you need complex numbers.  They're not auxiliary.  On the other hand, you can never measure a complex number.  You measure real numbers--  ammeter, position, weight, anything  that you really measure at the end of the day  is a real number.  So if the wave function was a complex number,  it was the issue of what is the physical interpretation.  And Max Born had the idea that you  have to calculate the real number called  the norm of this square, and this is  proportional to probabilities.  So that was a great discovery and had a lot  to do with the development of quantum mechanics.  Many people hated this.  In fact, Schrodinger himself hated it,  and his invention of the Schrodinger cat  was an attempt to show how ridiculous  was the idea of thinking of these things as probabilities.  But he was wrong, and Einstein was wrong in that way.  But when very good physicists are wrong,  they are not wrong for silly reasons,  they are wrong for good reasons, and we can learn a lot  from their thinking.  And this EPR are things that we will  discuss at some moment in your quantum sequence at MIT.  Einstein-Podolski-Rosen was an attempt  to show that quantum mechanics was wrong  and led to amazing discoveries.  It was the EPR paper itself was wrong,  but it brought up ideas that turned out  to be very important."
t3 = nlp(text3)
# print(t3)